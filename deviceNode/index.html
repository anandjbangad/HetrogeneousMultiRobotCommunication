<!DOCTYPE html>

<html>

<head>
    <meta charset="utf-8" name="viewport" content="width=device-width" />
    <title>
        Raspberry Pi Status
    </title>
    <!-- Socket.io import the module I have in the project -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <!-- Javascript Highcharts import the file directly from your server -->
    <script src="http://code.highcharts.com/highcharts.js"></script>
</head>

<body>
    <!--  'll have the div where the graph. I tell it that the width of the 
         screen is 100% and the height is 400px -->
    <div id="chart1" style="width:100%; height:200px;"></div>
    <div id="chart2" style="width:100%; height:200px;"></div>
    <!-- Javascript Begins -->
    <script>
        // I create a WebSocket . Put the IP of your Raspberry Pi! 
        var socket = io.connect('http://10.0.10.239:8001');
        // I create a new object 'Chart1'
        var chart1 = new Highcharts.Chart({
            chart: {
                renderTo: 'chart1',
                defaultSeriesType: 'spline',
                events: {
                    load: function () {
                        // Each time you receive a value from the socket, I put it on the graph
                        socket.on('temperatureUpdate', function (time, data) {
                            var series = chart1.series[0];
                            series.addPoint([time, data]);
                        });
                    }
                }
            },
            rangeSelector: {
                selected: 100
            },
            title: {
                text: 'CPU Temperature'
            },
            xAxis: {
                type: 'datetime',
                tickPixelInterval: 150,
                maxZoom: 20 * 1000
            },
            yAxis: {
                minPadding: 0.2,
                maxPadding: 0.2,
                title: {
                    text: 'Temperature ÂºC',
                    margin: 80
                }
            },
            series: [{
                name: 'Temperature',
                data: []
            }]
        });
        var chart2 = new Highcharts.Chart({
            chart: {
                renderTo: 'chart2',
                defaultSeriesType: 'spline',
                events: {
                    load: function () {
                        // Each time you receive a value from the socket, I put it on the graph
                        socket.on('cpu', function (time, cpuUtil) {
                            var series = chart2.series[0];
                            series.addPoint([time, cpuUtil]);
                        });
                    }
                }
            },
            rangeSelector: {
                selected: 100
            },
            title: {
                text: 'CPU Utilization'
            },
            xAxis: {
                type: 'datetime',
                tickPixelInterval: 150,
                maxZoom: 20 * 1000
            },
            yAxis: {
                minPadding: 0.2,
                maxPadding: 0.2,
                title: {
                    text: 'CPU %',
                    margin: 80
                }
            },
            series: [{
                name: 'CPU util',
                data: []
            }]
        });
    </script>
</body>

</html>